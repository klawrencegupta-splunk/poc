<form>
  <label>Capacity Estimates</label>
  <fieldset submitButton="false" autoRun="true">
    <input type="time" token="timer" searchWhenChanged="true">
      <label>Time RAnge</label>
      <default>
        <earliest>-24h@h</earliest>
        <latest>now</latest>
      </default>
    </input>
    <input type="dropdown" token="workload" searchWhenChanged="true">
      <label>workload filter</label>
      <choice value="75.00">75.00</choice>
      <choice value="80.00">80.00</choice>
      <choice value="85.00">85.00</choice>
      <choice value="90.00">90.00</choice>
      <choice value="100.00">no limit</choice>
      <default>100.00</default>
      <initialValue>100.00</initialValue>
    </input>
    <input type="dropdown" token="res" searchWhenChanged="true">
      <label>Time Resolution</label>
      <choice value="1h">1h</choice>
      <choice value="30m">30m</choice>
      <choice value="15m">15m</choice>
      <choice value="5m">5m</choice>
      <choice value="1m">1m</choice>
      <default>1h</default>
      <initialValue>1h</initialValue>
    </input>
    <input type="dropdown" token="func" searchWhenChanged="true">
      <label>Function</label>
      <choice value="max">max</choice>
      <choice value="avg">avg</choice>
      <choice value="median">median</choice>
      <choice value="mode">mode</choice>
      <choice value="first">first</choice>
      <choice value="last">last</choice>
      <default>avg</default>
      <initialValue>avg</initialValue>
      </input>
  </fieldset>
  <row>
    <panel>
      <title>Count of Indexers</title>
      <single>
        <search>
          <query>index=_introspection | stats dc(splunk_server) AS "Count of Indexers"</query>
          <earliest>$timer.earliest$</earliest>
          <latest>$timer.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
      </single>
    </panel>
    <panel>
      <title>Ingest Potential Rate - Blended Across all IDX ((core data based on Function + _time )</title>
      <single>
        <title>50/60/80/90 STDEV Percentiles</title>
        <search>
          <query>index=_introspection "data.writes_ps"="*" component=IOstats data.cpu_pct&lt;$workload$| bucket _time span=2m
| stats $func$(data.writes_kb_ps) AS wps $func$(data.reads_kb_ps) AS rps by host, _time | bucket _time span=$res$
| stats perc50(*ps) AS *ps50 perc60(*ps) AS *ps60 perc70(*ps) AS *ps70 perc80(*ps) AS *ps80 perc90(*ps) AS *ps90 | eval 50Ptotal=rps50 + wps50
| eval 60Ptotal=rps60 + wps60
| eval 70Ptotal=rps70 + wps70
| eval 80Ptotal=rps80 + wps80
| eval 90Ptotal=rps90 + wps90
| eval 50extrap_total_volume=('50Ptotal'*1440)/1024/1024
| eval 60extrap_total_volume=('60Ptotal'*1440)/1024/1024
| eval 70extrap_total_volume=('70Ptotal'*1440)/1024/1024
| eval 80extrap_total_volume=('80Ptotal'*1440)/1024/1024
| eval 90extrap_total_volume=('90Ptotal'*1440)/1024/1024
| table *total_volume</query>
          <earliest>$timer.earliest$</earliest>
          <latest>$timer.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0.00</option>
        <option name="rangeColors">["0x53a051","0x0877a6","0xf8be34","0xf1813f","0xdc4e41"]</option>
        <option name="refresh.display">progressbar</option>
        <option name="trellis.enabled">1</option>
      </single>
    </panel>
  </row>
  <row>
    <panel>
      <title>Ingest Potential Rate - Per Host Distribution of STDEV Percentiles  (core data based on Function + _time )</title>
      <chart>
        <title>Extrapolated GB/day indexer score using  STDEV (50/60/70/80/90) Percentiles grouped by GB/day rating</title>
        <search>
          <query>index=_introspection"data.writes_ps"="*" component=IOstats data.cpu_pct&lt;$workload$| bucket _time span=2m
| stats $func$(data.writes_kb_ps) AS wps $func$(data.reads_kb_ps) AS rps by host, _time | bucket _time span=$res$ | eval total = rps+wps
| stats perc50(total) AS 50Ptotal perc60(total) AS 60Ptotal perc70(total) AS 70Ptotal perc80(total) AS 80Ptotal perc90(total) AS 90Ptotal by host
| eval 50extrap_total_volume=('50Ptotal'*1440)/1024/1024
| eval 60extrap_total_volume=('60Ptotal'*1440)/1024/1024
| eval 70extrap_total_volume=('70Ptotal'*1440)/1024/1024
| eval 80extrap_total_volume=('80Ptotal'*1440)/1024/1024
| eval 90extrap_total_volume=('90Ptotal'*1440)/1024/1024
| stats max(*total*) AS *total* by host | fields *extrap*</query>
          <earliest>$timer.earliest$</earliest>
          <latest>$timer.latest$</latest>
          <sampleRatio>1</sampleRatio>
        </search>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.chart">scatter</option>
        <option name="charting.chart.showDataLabels">none</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.drilldown">none</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.legend.placement">none</option>
        <option name="height">498</option>
        <option name="refresh.display">progressbar</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">0</option>
        <option name="trellis.splitBy">_aggregation</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <title>Ingest Pattern - Reads/Writes per-second</title>
      <chart>
        <title>average over the time resolution</title>
        <search>
          <query>index=_introspection "data.writes_ps"="*" component=IOstats data.cpu_pct&lt;$workload$ | timechart span=$res$ avg(data.cpu_pct) AS workload avg(data.writes_kb_ps) AS Writes avg(data.reads_kb_ps) AS Reads</query>
          <earliest>$timer.earliest$</earliest>
          <latest>$timer.latest$</latest>
        </search>
        <option name="charting.axisY2.enabled">1</option>
        <option name="charting.chart">column</option>
        <option name="charting.chart.nullValueMode">connect</option>
        <option name="charting.chart.overlayFields">workload</option>
        <option name="charting.chart.showDataLabels">minmax</option>
        <option name="charting.chart.stackMode">stacked</option>
        <option name="charting.drilldown">none</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
  </row>
</form>