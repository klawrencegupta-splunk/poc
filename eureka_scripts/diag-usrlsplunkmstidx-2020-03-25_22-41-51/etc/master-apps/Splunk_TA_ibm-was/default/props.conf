[ibm:was:hpel]
MAX_TIMESTAMP_LOOKAHEAD = 128
TIME_PREFIX = \[
TIME_FORMAT = %m/%d/%y %H:%M:%S:%N %Z
BREAK_ONLY_BEFORE = ^\s*\[\d{1,2}/\d{1,2}/\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2}
REPORT-hpel = tabular_event_extract
FIELDALIAS-was_host = host as was_host
KV_MODE = None


[source::...(/|\\)ivtClient*.log*]
MAX_TIMESTAMP_LOOKAHEAD = 128
TIME_PREFIX = \[
TIME_FORMAT = %m/%d/%y %H:%M:%S:%N %Z
BREAK_ONLY_BEFORE = \[\d{1,2}/\d{1,2}/\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2}

sourcetype = ibm:was:ivtClientLog

[ibm:was:ivtClientLog]
FIELDALIAS-was_host = host as was_host


[source::...(/|\\)wsadmin.traceout*]
MAX_TIMESTAMP_LOOKAHEAD = 128
TIME_PREFIX = \[
TIME_FORMAT = %m/%d/%y %H:%M:%S:%N %Z
BREAK_ONLY_BEFORE = ^\[\d{1,2}/\d{1,2}/\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2}

sourcetype = ibm:was:wsadminTraceout

[ibm:was:wsadminTraceout]
REPORT-profile = profile_extract
FIELDALIAS-was_host = host as was_host
REPORT-traceout = tabular_event_extract
KV_MODE = None


[source::...(/|\\)native_stdout*.log*]
MAX_TIMESTAMP_LOOKAHEAD = 128
TIME_PREFIX = \[
TIME_FORMAT = %m/%d/%y %H:%M:%S:%N %Z
BREAK_ONLY_BEFORE = ^\[\d{1,2}/\d{1,2}/\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2}
MAX_EVENTS = 1000

sourcetype = ibm:was:nativeStdOutLog

[ibm:was:nativeStdOutLog]
REPORT-was_server = server_extract
FIELDALIAS-was_host = host as was_host
REPORT-native_stdout = tabular_event_extract
EXTRACT-websphere_verbosegcMessage = (?P<websphere_verbosegcMessage><\?xml(.*)</verbosegc>)
KV_MODE = None


[source::...(/|\\)native_stderr*.log*]
MAX_TIMESTAMP_LOOKAHEAD = 128
TIME_PREFIX = \[
TIME_FORMAT = %m/%d/%y %H:%M:%S:%N %Z
BREAK_ONLY_BEFORE = ^\[\d{1,2}/\d{1,2}/\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2}
MAX_EVENTS = 10000

sourcetype = ibm:was:nativeStdErrLog

[ibm:was:nativeStdErrLog]
REPORT-was_server = server_extract
FIELDALIAS-was_host = host as was_host


[source::...(/|\\)startServer*.log*]
MAX_TIMESTAMP_LOOKAHEAD = 128
TIME_PREFIX = \[
TIME_FORMAT = %m/%d/%y %H:%M:%S:%N %Z
BREAK_ONLY_BEFORE = ^\[\d{1,2}/\d{1,2}/\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2}

sourcetype = ibm:was:startServerLog

[ibm:was:startServerLog]
REPORT-was_server = server_extract
FIELDALIAS-was_host = host as was_host
REPORT-start_server = tabular_event_extract
KV_MODE = None


[source::...(/|\\)stopServer*.log*]
MAX_TIMESTAMP_LOOKAHEAD = 128
TIME_PREFIX = \[
TIME_FORMAT = %m/%d/%y %H:%M:%S:%N %Z
BREAK_ONLY_BEFORE = ^\[\d{1,2}/\d{1,2}/\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2}

sourcetype = ibm:was:stopServerLog

[ibm:was:stopServerLog]
REPORT-was_server = server_extract
FIELDALIAS-was_host = host as was_host
REPORT-stop_server = tabular_event_extract
KV_MODE = None


[source::...(/|\\)serverStatus*.log*]
MAX_TIMESTAMP_LOOKAHEAD = 128
TIME_PREFIX = \[
TIME_FORMAT = %m/%d/%y %H:%M:%S:%N %Z
BREAK_ONLY_BEFORE = ^\[\d{1,2}/\d{1,2}/\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2}

sourcetype = ibm:was:serverStatus

[ibm:was:serverStatus]
REPORT-profile = profile_extract
FIELDALIAS-was_host = host as was_host
REPORT-server_status = tabular_event_extract
KV_MODE = None


[source::...(/|\\)SystemOut*.log*]
MAX_TIMESTAMP_LOOKAHEAD = 128
TIME_PREFIX = \[
TIME_FORMAT = %m/%d/%y %H:%M:%S:%N %Z
BREAK_ONLY_BEFORE = ^\[\d{1,2}/\d{1,2}/\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2}

sourcetype = ibm:was:systemOutLog

[ibm:was:systemOutLog]
REPORT-systemoutd = tabular_event_extract
REPORT-was_server = server_extract
FIELDALIAS-was_host = host as was_host
KV_MODE = None

[source::...(/|\\)SystemErr*.log*]
MAX_TIMESTAMP_LOOKAHEAD = 128
TIME_PREFIX = \[
TIME_FORMAT = %m/%d/%y %H:%M:%S:%N %Z
# BREAK_ONLY_BEFORE = \[\d{1,2}/\d{1,2}/\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2}
BREAK_ONLY_BEFORE = ^\*{10}

sourcetype = ibm:was:systemErrLog

[ibm:was:systemErrLog]
REPORT-was_server = server_extract
FIELDALIAS-was_host = host as was_host
MAX_EVENTS = 10000


[source::...(/|\\)javacore*.txt*]
MAX_EVENTS = 13000
BREAK_ONLY_BEFORE = ^NULL\s+[-]{30,}

sourcetype = ibm:was:javacore

[ibm:was:javacore]
EXTRACT-wasSubComponentDumpRoutine = ^(?i)0SECTION\s*(?P<wasSubComponentDumpRoutine>.*)
FIELDALIAS-was_host = host as was_host


[source::...(/|\\)http_access.log*]
MAX_TIMESTAMP_LOOKAHEAD = 128
TIME_PREFIX = \[
# TIME_FORMAT = %m/%d/%y %H:%M:%S:%N %Z
# BREAK_ONLY_BEFORE = ^\[\d{1,2}/\d{1,2}/\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2}

sourcetype = ibm:was:httpLog

[ibm:was:httpLog]
EXTRACT-wasIPaddress = (?i)^(?P<wasIPaddress>[^ ]+)
EXTRACT-wasHTTPmethod = (?i)^[^"]*"(?P<wasHTTPmethod>[^ ]+)
EXTRACT-wasHTTPstatuscode = (?i)^(?:[^ ]* ){8}(?P<wasHTTPstatuscode>[^ ]+)
EXTRACT-wasrequestURL = (?i)^[^"]*"\w+\s+(?P<wasRequestURL>[^ ]+)
EXTRACT-wasHTTPversion = (?i)\..*? (?P<wasHTTPversion>\w+/\d+\.\d+)(?=")
EXTRACT-wasPageLength = (?i)^(?:[^ ]* ){9}(?P<wasPageLength>.+)
REPORT-was_server = server_extract
FIELDALIAS-was_host = host as was_host
FIELDALIAS-CIM = wasIPaddress AS src wasHTTPmethod AS http-method wasHTTPstatuscode AS status wasrequestURL AS URL wasPageLength AS bytes_in
FIELDALIAS-response_code = wasHTTPstatuscode AS response_code
LOOKUP-ibm_was_inventory_server_instance = ibm_was_inventory server_name_part AS source, host OUTPUT as_port as appserver_port_number application_server as_host
LOOKUP-ibm_was_inventory_application_instance = ibm_was_inventory2 server_name_part AS source, host OUTPUT application_instance


# First Failure Data Capture
[source::...(/|\\)ffdc(/|\\)*.txt*]
MAX_TIMESTAMP_LOOKAHEAD = 128
TIME_PREFIX = \[
TIME_FORMAT = %m/%d/%y %H:%M:%S:%N %Z
BREAK_ONLY_BEFORE = ^\[\d{1,2}/\d{1,2}/\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2}
MAX_EVENTS = 10000

sourcetype = ibm:was:ffdc

[ibm:was:ffdc]
FIELDALIAS-was_host = host as was_host
REPORT-exception = extract_exception


[source::...(/|\\)pmt.log*]
sourcetype = ibm:was:profileManagementLog

[ibm:was:profileManagementLog]
FIELDALIAS-was_host = host as was_host


[source::...(/|\\)*create*.log]
TIME_PREFIX = <date>
BREAK_ONLY_BEFORE = <record>
MAX_TIMESTAMP_LOOKAHEAD = 128
sourcetype = ibm:was:profileCreationLog

[ibm:was:profileCreationLog]
FIELDALIAS-was_host = host as was_host


[source::...(/|\\)*TextLog*]
MAX_TIMESTAMP_LOOKAHEAD = 128
TIME_PREFIX = \[
TIME_FORMAT = %m/%d/%y %H:%M:%S:%N %Z
BREAK_ONLY_BEFORE = ^\[\d{1,2}/\d{1,2}/\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2}

sourcetype = ibm:was:textLog

[ibm:was:textLog]
REPORT-text_log = tabular_event_extract
FIELDALIAS-was_host = host as was_host
KV_MODE = None


[source::...(/|\\)*exception*(.log|.txt)]
SHOULD_LINEMERGE = false
sourcetype = ibm:was:serverExceptionLog

[ibm:was:serverExceptionLog]
FIELDALIAS-was_host = host as was_host
REPORT-exception = extract_exception
KV_MODE = None


[source::...(/|\\)activity.log*]
TRUNCATE=0
MAX_EVENTS = 10000
LINE_BREAKER = (?<=</CommonBaseEvent>)([\w\W]*)(?=<CommonBaseEvent)
BREAK_ONLY_BEFORE = <CommonBaseEvent
sourcetype = ibm:was:activityLog

[ibm:was:activityLog]
REPORT-profile= profile_extract
FIELDALIAS-was_host = host as was_host
# appserver
# FIELDALIAS-ip_address = location as ip_address


[source::...manageprofiles...]
sourcetype = ibm:was:manageprofiles

[ibm:was:manageprofiles]
KV_MODE = xml
# REPORT-mgmt_profile = mgmt_profile_extract
FIELDALIAS-was_host = host as was_host
EXTRACT-profile = (?<profile>[^\\/]*)_.*$ in source
BREAK_ONLY_BEFORE = ^<record>

[source::...derby.log*]
MAX_TIMESTAMP_LOOKAHEAD = 128
SHOULD_LINEMERGE = true
# Sat Jun 13 00:36:20 CST 2015:
BREAK_ONLY_BEFORE = ^\s*\w+\s+\w+\s+\d+\s+\d{1,2}:\d{1,2}:\d{1,2}
TIME_PREFIX = ^\s*
TIME_FORMAT = %a %b %d %H:%M:%S %Z %Y
MAX_EVENTS = 10000

sourcetype = ibm:was:derby
[ibm:was:derby]
FIELDALIAS-was_host = host as was_host

[source::...(/|\\)orbtrc*.txt*]
MAX_TIMESTAMP_LOOKAHEAD = 128
SHOULD_LINEMERGE = true
BREAK_ONLY_BEFORE = \d{1,2}:\d{1,2}:\d{1,2}
MAX_EVENTS = 10000

sourcetype = ibm:was:orbtrc

[ibm:was:orbtrc]
FIELDALIAS-was_host = host as was_host
KV_MODE = None


[source::...(/|\\)addNode.log*]
MAX_TIMESTAMP_LOOKAHEAD = 128
TIME_PREFIX = \[
TIME_FORMAT = %m/%d/%y %H:%M:%S:%N %Z
BREAK_ONLY_BEFORE = ^\[\d{1,2}/\d{1,2}/\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2}

sourcetype = ibm:was:addNodeLog

[ibm:was:addNodeLog]
FIELDALIAS-was_host = host as was_host

[source::...WsnAdminNameService...]
KV_MODE = json
TRANSFORMS-override_sourcetype = override_sourcetype
TRANSFORMS-override_source = override_source


[ibm:was:jmx]
KV_MODE = json
FIELDALIAS-server = mbean_property_process as server
FIELDALIAS-node = mbean_property_node as node
FIELDALIAS-cell = mbean_property_cell as cell
FIELDALIAS-jvm_description = jvmDescription as jvm_description
# appserver
FIELDALIAS-full_host_name = host AS full_host_name
FIELDALIAS-product_family = mbean_domain AS product_family
EVAL-vendor_product = "WebSphere Application Server"
FIELDALIAS-version_number = mbean_property_version AS version_number
#FIELDALIAS-application_server = mbean_property_node AS application_server
EVAL-ip_address = replace(host,"([^:]+):(.*)","\1")
EVAL-server_name = COALESCE(mbean_property_J2EEServer, mbean_property_Server, mbean_property_process)
LOOKUP-ibm_was_inventory_server_instance = ibm_was_inventory server_name, cell OUTPUT as_port as appserver_port_number application_server as_host 
LOOKUP-ibm_was_inventory_application_instance = ibm_was_inventory2 server_name, cell OUTPUT application_instance


[source::WebSphere:...type=JVM...]
FIELDALIAS-vendor_product_runtime = mbean_property_name AS vendor_product_runtime
FIELDALIAS-runtime_vendor = javaVendor AS runtime_vendor
FIELDALIAS-vendor_product_runtime_version = javaVersion AS vendor_product_runtime_version
EVAL-memory_heap_free_percent = round(if(heapSize == 0, 0, freeMemory / heapSize * 100), 2)
EVAL-cpu_utilization_percent = round('stats.ProcessCpuUsage.count', 2)
EVAL-memory_heap_used = round('stats.UsedMemory.count' / 1024, 2)
EVAL-memory_heap_size = round('stats.HeapSize.current' / 1024, 2)

[source::WebSphere:...type=(Servlet|JSP)...]
FIELDALIAS-request_count = stats.webAppModule.servlets.totalRequests.count AS request_count
EVAL-response_time = round(if('stats.webAppModule.servlets.responseTime.count' == 0, 0, 'stats.webAppModule.servlets.responseTime.totalTime' / 'stats.webAppModule.servlets.responseTime.count'), 2)

[source::WebSphere:...type=SessionManager...]
FIELDALIAS-active_sessions_count = stats.ActiveCount.current AS active_sessions_count
FIELDALIAS-rejected_sessions_count = stats.NoRoomForNewSessionCount.count AS rejected_sessions_count
EVAL-expired_sessions_count = 'stats.CreateCount.count' - 'stats.ActiveCount.current'

[source::WebSphere:...type=ThreadPool...]
EVAL-available_threads_count_percent = round(100 - 'stats.PercentUsed.current', 2)
FIELDALIAS-active_threads_count = stats.ActiveCount.current AS active_threads_count
FIELDALIAS-hung_threads_count = stats.DeclaredThreadHungCount.count AS hung_threads_count

[source::WebSphere:...type=Application...]
FIELDALIAS-application_name = name AS application_name
EVAL-application_instance = application_server + " " + application_name

[ibm:was:serverIndex]
KV_MODE=xml
DATETIME_CONFIG = CURRENT
SHOULD_LINEMERGE=false
pulldown_type=true
LINE_BREAKER = (>\s*?\n*?\r*?\s*?)(?=<serverEntries)
REPORT-server_name = server_name_regex
REPORT-host-and-port = host_and_port_regex
REPORT-appname = appname
LOOKUP-ibm_was_inventory_server_instance = ibm_was_inventory source, host OUTPUT as_port as appserver_port_number application_server
LOOKUP-ibm_was_inventory_application_instance = ibm_was_inventory2 source, host OUTPUT application_instance


[ibm:was:gcLog]
KV_MODE=xml
EVAL-memory_pool_size = round('gc-end.mem-info{@total}'/1024/1024, 2)
EVAL-memory_used = round(('gc-end.mem-info{@total}'-'gc-end.mem-info{@free}')/1024/1024, 2)
EVAL-garbage_collection_time = round('gc-end{@durationms}', 2)
EVAL-garbage_collection_count = if(isnotnull('gc-end{@durationms}'),1, null())
LOOKUP-ibm_was_inventory_server_instance = ibm_was_inventory server_name_part AS source, host OUTPUT as_port as appserver_port_number application_server as_host 
LOOKUP-ibm_was_inventory_application_instance = ibm_was_inventory2 server_name_part AS source, host OUTPUT application_instance


